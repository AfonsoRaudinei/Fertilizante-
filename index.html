<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Fertilizantes</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(180deg, #F5F5F7 0%, #E5E5E7 100%);
            padding: 10px;
            min-height: 100vh;
        }
        
        .container { max-width: 100%; margin: 0 auto; }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        
        h1 { font-size: 16px; font-weight: 600; color: #1D1D1F; margin-bottom: 12px; }
        h2 {
            font-size: 13px;
            font-weight: 600;
            color: #1D1D1F;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #007AFF;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        label {
            font-size: 10px;
            font-weight: 600;
            color: #86868B;
            margin-bottom: 4px;
            text-transform: uppercase;
            display: block;
        }
        
        input, select {
            padding: 10px;
            border: 1px solid #D1D1D6;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            width: 100%;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0,122,255,0.1);
        }
        
        .header-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .nutrients-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .fert-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 8px; }
        .secondary-grid { display: none; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-bottom: 8px; }
        .secondary-grid.show { display: grid; }
        
        .nutrient-badge {
            background: #F5F5F7;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #E5E5E7;
        }
        
        .nutrient-badge.primary {
            border-color: #007AFF;
            background: linear-gradient(135deg, rgba(0,122,255,0.1), rgba(0,122,255,0.05));
        }
        
        .nutrient-badge.secondary {
            border-color: #34C759;
            background: linear-gradient(135deg, rgba(52,199,89,0.1), rgba(52,199,89,0.05));
        }
        
        .nutrient-badge input {
            text-align: center;
            font-size: 16px;
            font-weight: 600;
        }
        
        .priority { font-size: 9px; font-weight: 600; margin-top: 6px; text-transform: uppercase; }
        .primary .priority { color: #007AFF; }
        .secondary .priority { color: #34C759; }
        
        .input-card {
            background: #F5F5F7;
            border: 2px solid #E5E5E7;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }
        
        .fert-item {
            background: #F5F5F7;
            padding: 14px;
            border-radius: 12px;
            margin-bottom: 10px;
            border: 2px solid #E5E5E7;
        }
        
        .fert-item.excluded { border-color: #FF3B30; background: rgba(255,59,48,0.05); }
        
        .fert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .fert-name { font-weight: 600; color: #1D1D1F; font-size: 15px; }
        .fert-formula { font-size: 12px; color: #86868B; }
        
        .fert-actions { display: flex; gap: 6px; }
        
        .btn-icon {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s;
        }
        
        .btn-edit { background: #007AFF; }
        .btn-edit:hover { background: #0051D5; transform: scale(1.1); }
        .btn-remove { background: #FF3B30; font-weight: 300; }
        .btn-remove:hover { background: #e53329; transform: scale(1.1); }
        
        .values-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .value-item { text-align: center; }
        .value-label { font-size: 9px; color: #86868B; text-transform: uppercase; margin-bottom: 2px; }
        .value { font-size: 13px; font-weight: 600; color: #1D1D1F; }
        
        .prices-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        
        .price-item {
            background: white;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
        }
        
        button {
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #007AFF, #0051D5);
            color: white;
            box-shadow: 0 4px 12px rgba(0,122,255,0.3);
        }
        
        .btn-add, .btn-save {
            background: #34C759;
            color: white;
        }
        
        .btn-cancel {
            background: #86868B;
            color: white;
            margin-top: 8px;
        }
        
        .toggle-expand {
            display: flex;
            align-items: center;
            gap: 6px;
            color: #007AFF;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 8px;
        }
        
        .toggle-expand:hover { background: rgba(0,122,255,0.1); }
        .expand-icon { transition: transform 0.3s; }
        .expand-icon.open { transform: rotate(180deg); }
        
        .checkbox-row {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            border: 2px solid #E5E5E7;
            cursor: pointer;
        }
        
        .checkbox-row:hover { border-color: #FF3B30; }
        .checkbox-row input { width: 18px; height: 18px; cursor: pointer; }
        .checkbox-row label { cursor: pointer; color: #FF3B30; font-weight: 600; font-size: 12px; text-transform: none; }
        
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 6px;
        }
        
        .badge-best { background: #34C759; color: white; }
        .badge-excluded { background: #FF3B30; color: white; padding: 2px 6px; border-radius: 8px; font-size: 9px; }
        
        .result {
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            border: 2px solid #81C784;
        }
        
        .result.best {
            background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
        }
        
        .result.second {
            background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
            border-color: #FFB74D;
        }
        
        .result h3 {
            font-size: 15px;
            color: #2E7D32;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .result.second h3 { color: #E65100; }
        
        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            font-size: 13px;
        }
        
        .result-total {
            font-weight: 600;
            font-size: 16px;
            margin-top: 8px;
            padding-top: 12px;
            border-top: 2px solid #2E7D32;
            display: flex;
            justify-content: space-between;
        }
        
        .grain-info {
            background: rgba(0,122,255,0.08);
            border: 1px solid rgba(0,122,255,0.3);
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 12px;
        }
        
        .grain-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
        }
        
        .grain-value { font-weight: 600; color: #007AFF; }
        
        .empty { text-align: center; padding: 24px; color: #86868B; font-size: 13px; }
        
        .save-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(52,199,89,0.95);
            color: white;
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .save-badge.show { opacity: 1; }
        
        @media (max-width: 768px) {
            .header-grid, .nutrients-grid { grid-template-columns: 1fr; }
            .fert-row { grid-template-columns: repeat(3, 1fr); }
            .values-grid { grid-template-columns: repeat(3, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>üåæ Calculadora de Fertilizantes</h1>
            <div class="header-grid">
                <div>
                    <label>Cultura</label>
                    <select id="crop" onchange="changeCrop()">
                        <option value="soja">üå± Soja</option>
                        <option value="milho">üåΩ Milho</option>
                    </select>
                </div>
                <div>
                    <label>√Årea (ha)</label>
                    <input type="number" id="area" value="100" step="0.1" oninput="save()">
                </div>
                <div>
                    <label id="grainLabel">Soja (R$/sc)</label>
                    <input type="number" id="grainPrice" value="120" step="0.1" oninput="save()">
                </div>
            </div>
        </div>

        <div class="card">
            <h2>üéØ Necessidades (kg/ha)</h2>
            <div class="nutrients-grid" id="nutrients"></div>
        </div>

        <div class="card">
            <h2>üìã Fertilizantes</h2>
            
            <div class="input-card">
                <div style="margin-bottom: 12px;">
                    <label>Nome</label>
                    <input type="text" id="name" placeholder="Ex: MAP, KCl, Ureia">
                </div>

                <div class="fert-row">
                    <div><label>N (%)</label><input type="number" id="n" value="0" step="0.1"></div>
                    <div><label>P‚ÇÇO‚ÇÖ (%)</label><input type="number" id="p" value="0" step="0.1"></div>
                    <div><label>K‚ÇÇO (%)</label><input type="number" id="k" value="0" step="0.1"></div>
                    <div><label>Pre√ßo (R$/ton)</label><input type="number" id="price" step="10"></div>
                    <div><label>Frete (R$/ton)</label><input type="number" id="freight" value="0" step="10"></div>
                </div>

                <div class="toggle-expand" onclick="toggleSecondary()">
                    <span class="expand-icon" id="icon">‚ñ≤</span>
                    <span>Ca, S, B e outros</span>
                </div>

                <div class="secondary-grid" id="secondary">
                    <div><label>Ca %</label><input type="number" id="ca" value="0" step="0.1"></div>
                    <div><label>S %</label><input type="number" id="s" value="0" step="0.1"></div>
                    <div><label>B %</label><input type="number" id="b" value="0" step="0.01"></div>
                    <div><label>Outros %</label><input type="number" id="other" value="0" step="0.1"></div>
                </div>

                <div class="checkbox-row">
                    <input type="checkbox" id="exclude">
                    <label for="exclude">üö´ Excluir de combina√ß√µes (tem P+K)</label>
                </div>

                <button class="btn-add" id="addBtn" onclick="add()">+ Adicionar</button>
                <button class="btn-save" id="saveBtn" onclick="saveEdit()" style="display:none;">üíæ Salvar</button>
                <button class="btn-cancel" id="cancelBtn" onclick="cancel()" style="display:none;">Cancelar</button>
            </div>
            
            <div id="list"></div>
        </div>

        <button class="btn-primary" onclick="calculate()">üí∞ Calcular Melhores Combina√ß√µes</button>
        <div id="results"></div>
    </div>

    <div class="save-badge" id="saveBadge">‚úì Salvo</div>

    <script>
        let crop = 'soja';
        let ferts = [];
        let editing = -1;

        const config = {
            soja: {
                label: 'Soja',
                nutrients: [
                    { id: 'P', label: 'P‚ÇÇO‚ÇÖ', priority: 'primary', text: '1¬™', val: 90 },
                    { id: 'K', label: 'K‚ÇÇO', priority: 'secondary', text: '2¬™', val: 120 },
                    { id: 'N', label: 'N', priority: null, text: '-', val: 0, disabled: true }
                ]
            },
            milho: {
                label: 'Milho',
                nutrients: [
                    { id: 'N', label: 'N', priority: 'primary', text: '1¬™', val: 120 },
                    { id: 'K', label: 'K‚ÇÇO', priority: 'secondary', text: '2¬™', val: 100 },
                    { id: 'P', label: 'P‚ÇÇO‚ÇÖ', priority: null, text: '3¬™', val: 80 }
                ]
            }
        };

        function toggleSecondary() {
            const el = document.getElementById('secondary');
            const icon = document.getElementById('icon');
            if (el.classList.contains('show')) {
                el.classList.remove('show');
                icon.classList.remove('open');
            } else {
                el.classList.add('show');
                icon.classList.add('open');
            }
        }

        function save() {
            localStorage.setItem('fertCalc', JSON.stringify({
                crop,
                area: document.getElementById('area').value,
                price: document.getElementById('grainPrice').value,
                needs: {
                    N: document.getElementById('needN')?.value || 0,
                    P: document.getElementById('needP')?.value || 0,
                    K: document.getElementById('needK')?.value || 0
                },
                ferts
            }));
            const badge = document.getElementById('saveBadge');
            badge.classList.add('show');
            setTimeout(() => badge.classList.remove('show'), 2000);
        }

        function load() {
            const data = localStorage.getItem('fertCalc');
            if (data) {
                try {
                    const d = JSON.parse(data);
                    crop = d.crop || 'soja';
                    document.getElementById('crop').value = crop;
                    if (d.area) document.getElementById('area').value = d.area;
                    if (d.price) document.getElementById('grainPrice').value = d.price;
                    if (d.ferts) ferts = d.ferts;
                    changeCrop();
                    setTimeout(() => {
                        if (d.needs) {
                            if (document.getElementById('needN')) document.getElementById('needN').value = d.needs.N;
                            if (document.getElementById('needP')) document.getElementById('needP').value = d.needs.P;
                            if (document.getElementById('needK')) document.getElementById('needK').value = d.needs.K;
                        }
                    }, 100);
                } catch(e) {}
            }
        }

        function changeCrop() {
            crop = document.getElementById('crop').value;
            document.getElementById('grainLabel').textContent = config[crop].label + ' (R$/sc)';
            renderNutrients();
            save();
        }

        function renderNutrients() {
            const c = config[crop];
            document.getElementById('nutrients').innerHTML = c.nutrients.map(n => `
                <div class="nutrient-badge ${n.priority || ''}">
                    <label>${n.label}</label>
                    <input type="number" id="need${n.id}" value="${n.val}" ${n.disabled ? 'disabled' : ''} step="1" oninput="save()" style="${n.disabled ? 'background:#F5F5F7;color:#C7C7CC' : ''}">
                    <div class="priority">${n.text}</div>
                </div>
            `).join('');
        }

        function clear() {
            document.getElementById('name').value = '';
            ['n','p','k','ca','s','b','other'].forEach(id => document.getElementById(id).value = '0');
            document.getElementById('price').value = '';
            document.getElementById('freight').value = '0';
            document.getElementById('exclude').checked = false;
            editing = -1;
            document.getElementById('addBtn').style.display = 'block';
            document.getElementById('saveBtn').style.display = 'none';
            document.getElementById('cancelBtn').style.display = 'none';
        }

        function add() {
            const name = document.getElementById('name').value.trim();
            const n = parseFloat(document.getElementById('n').value) || 0;
            const p = parseFloat(document.getElementById('p').value) || 0;
            const k = parseFloat(document.getElementById('k').value) || 0;
            const ca = parseFloat(document.getElementById('ca').value) || 0;
            const s = parseFloat(document.getElementById('s').value) || 0;
            const b = parseFloat(document.getElementById('b').value) || 0;
            const other = parseFloat(document.getElementById('other').value) || 0;
            const price = parseFloat(document.getElementById('price').value) || 0;
            const freight = parseFloat(document.getElementById('freight').value) || 0;
            const exclude = document.getElementById('exclude').checked;

            if (!name || (n === 0 && p === 0 && k === 0) || price === 0) {
                alert('Preencha nome, nutriente e pre√ßo!');
                return;
            }

            ferts.push({ name, n, p, k, ca, s, b, other, price, freight, exclude });
            clear();
            render();
            save();
        }

        function edit(i) {
            editing = i;
            const f = ferts[i];
            
            document.getElementById('name').value = f.name;
            document.getElementById('n').value = f.n;
            document.getElementById('p').value = f.p;
            document.getElementById('k').value = f.k;
            document.getElementById('ca').value = f.ca || 0;
            document.getElementById('s').value = f.s || 0;
            document.getElementById('b').value = f.b || 0;
            document.getElementById('other').value = f.other || 0;
            document.getElementById('price').value = f.price;
            document.getElementById('freight').value = f.freight;
            document.getElementById('exclude').checked = f.exclude || false;

            document.getElementById('addBtn').style.display = 'none';
            document.getElementById('saveBtn').style.display = 'block';
            document.getElementById('cancelBtn').style.display = 'block';

            document.getElementById('name').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function saveEdit() {
            if (editing === -1) return;

            const name = document.getElementById('name').value.trim();
            const n = parseFloat(document.getElementById('n').value) || 0;
            const p = parseFloat(document.getElementById('p').value) || 0;
            const k = parseFloat(document.getElementById('k').value) || 0;
            const ca = parseFloat(document.getElementById('ca').value) || 0;
            const s = parseFloat(document.getElementById('s').value) || 0;
            const b = parseFloat(document.getElementById('b').value) || 0;
            const other = parseFloat(document.getElementById('other').value) || 0;
            const price = parseFloat(document.getElementById('price').value) || 0;
            const freight = parseFloat(document.getElementById('freight').value) || 0;
            const exclude = document.getElementById('exclude').checked;

            if (!name || (n === 0 && p === 0 && k === 0) || price === 0) {
                alert('Preencha nome, nutriente e pre√ßo!');
                return;
            }

            ferts[editing] = { name, n, p, k, ca, s, b, other, price, freight, exclude };
            clear();
            render();
            save();
        }

        function cancel() {
            clear();
        }

        function remove(i) {
            if (confirm('Remover fertilizante?')) {
                ferts.splice(i, 1);
                render();
                save();
            }
        }

        function render() {
            const list = document.getElementById('list');
            if (ferts.length === 0) {
                list.innerHTML = '<div class="empty">Nenhum fertilizante</div>';
                return;
            }
            list.innerHTML = ferts.map((f, i) => `
                <div class="fert-item ${f.exclude ? 'excluded' : ''}">
                    <div class="fert-header">
                        <div>
                            <div class="fert-name">
                                ${f.name}
                                ${f.exclude ? '<span class="badge-excluded">P+K</span>' : ''}
                            </div>
                            <div class="fert-formula">${f.n}-${f.p}-${f.k}</div>
                        </div>
                        <div class="fert-actions">
                            <button class="btn-icon btn-edit" onclick="edit(${i})">‚úèÔ∏è</button>
                            <button class="btn-icon btn-remove" onclick="remove(${i})">√ó</button>
                        </div>
                    </div>
                    <div class="values-grid">
                        <div class="value-item"><div class="value-label">N</div><div class="value">${f.n.toFixed(1)}%</div></div>
                        <div class="value-item"><div class="value-label">P‚ÇÇO‚ÇÖ</div><div class="value">${f.p.toFixed(1)}%</div></div>
                        <div class="value-item"><div class="value-label">K‚ÇÇO</div><div class="value">${f.k.toFixed(1)}%</div></div>
                        <div class="value-item"><div class="value-label">Ca</div><div class="value">${f.ca.toFixed(1)}%</div></div>
                        <div class="value-item"><div class="value-label">S</div><div class="value">${f.s.toFixed(1)}%</div></div>
                    </div>
                    <div class="prices-grid">
                        <div class="price-item"><div class="value-label">Pre√ßo</div><div class="value">R$ ${f.price.toFixed(0)}/ton</div></div>
                        <div class="price-item"><div class="value-label">Frete</div><div class="value">R$ ${f.freight.toFixed(0)}/ton</div></div>
                    </div>
                </div>
            `).join('');
        }

        function calculate() {
            const area = parseFloat(document.getElementById('area').value) || 0;
            const grainPrice = parseFloat(document.getElementById('grainPrice').value) || 0;
            const needN = parseFloat(document.getElementById('needN').value) || 0;
            const needP = parseFloat(document.getElementById('needP').value) || 0;
            const needK = parseFloat(document.getElementById('needK').value) || 0;

            if (area === 0 || grainPrice === 0 || ferts.length === 0) {
                alert('Preencha √°rea, pre√ßo do gr√£o e cadastre fertilizantes!');
                return;
            }

            const combos = [];
            const valid = ferts.filter(f => !f.exclude);
            
            for (let i = 0; i < valid.length; i++) {
                for (let j = i + 1; j < valid.length; j++) {
                    const f1 = valid[i];
                    const f2 = valid[j];
                    
                    let dose1 = 0, dose2 = 0;
                    
                    // P primeiro
                    if (needP > 0) {
                        if (f1.p > 0 && f2.p === 0) dose1 = (needP * 100) / f1.p;
                        else if (f2.p > 0 && f1.p === 0) dose2 = (needP * 100) / f2.p;
                        else if (f1.p > f2.p) dose1 = (needP * 100) / f1.p;
                        else if (f2.p > 0) dose2 = (needP * 100) / f2.p;
                    }
                    
                    // K depois
                    const kGot1 = (dose1 * f1.k) / 100;
                    const kGot2 = (dose2 * f2.k) / 100;
                    const kNeed = Math.max(0, needK - kGot1 - kGot2);
                    
                    if (kNeed > 0) {
                        if (f1.k > 0 && (dose1 === 0 || f1.p === 0)) {
                            dose1 = Math.max(dose1, (kNeed * 100) / f1.k);
                        } else if (f2.k > 0 && (dose2 === 0 || f2.p === 0)) {
                            dose2 = Math.max(dose2, (kNeed * 100) / f2.k);
                        }
                    }
                    
                    // N depois
                    const nGot1 = (dose1 * f1.n) / 100;
                    const nGot2 = (dose2 * f2.n) / 100;
                    const nNeed = Math.max(0, needN - nGot1 - nGot2);
                    
                    if (nNeed > 0) {
                        if (f1.n > 0 && dose1 === 0) dose1 = (nNeed * 100) / f1.n;
                        else if (f2.n > 0 && dose2 === 0) dose2 = (nNeed * 100) / f2.n;
                    }
                    
                    if (dose1 > 0 || dose2 > 0) {
                        const ton1 = (dose1 / 1000) * area;
                        const ton2 = (dose2 / 1000) * area;
                        const cost1 = ton1 * (f1.price + f1.freight);
                        const cost2 = ton2 * (f2.price + f2.freight);
                        const total = cost1 + cost2;
                        
                        combos.push({
                            name: `${f1.name} + ${f2.name}`,
                            f1: { name: f1.name, dose: dose1, ton: ton1, cost: cost1 },
                            f2: { name: f2.name, dose: dose2, ton: ton2, cost: cost2 },
                            total,
                            perHa: total / area,
                            sacks: (total / area) / grainPrice
                        });
                    }
                }
            }
            
            if (combos.length === 0) {
                alert('Nenhuma combina√ß√£o poss√≠vel!');
                return;
            }
            
            combos.sort((a, b) => a.total - b.total);
            showResults(combos, grainPrice);
        }

        function showResults(combos, grainPrice) {
            const res = document.getElementById('results');
            const cropName = config[crop].label;
            
            let html = '';
            
            // Melhor
            if (combos[0]) {
                const c = combos[0];
                html += `
                    <div class="result best">
                        <h3>ü•á ${c.name} <span class="badge badge-best">Melhor</span></h3>
                        <div class="result-row"><span>${c.f1.name}:</span><strong>${c.f1.dose.toFixed(1)} kg/ha</strong></div>
                        <div class="result-row"><span>Total:</span><strong>${c.f1.ton.toFixed(2)} ton</strong></div>
                        <div class="result-row"><span>Custo:</span><strong>R$ ${c.f1.cost.toLocaleString('pt-BR', {minimumFractionDigits:2})}</strong></div>
                        <div style="height:8px"></div>
                        <div class="result-row"><span>${c.f2.name}:</span><strong>${c.f2.dose.toFixed(1)} kg/ha</strong></div>
                        <div class="result-row"><span>Total:</span><strong>${c.f2.ton.toFixed(2)} ton</strong></div>
                        <div class="result-row"><span>Custo:</span><strong>R$ ${c.f2.cost.toLocaleString('pt-BR', {minimumFractionDigits:2})}</strong></div>
                        <div class="result-total"><span>TOTAL:</span><strong>R$ ${c.total.toLocaleString('pt-BR', {minimumFractionDigits:2})}</strong></div>
                        <div class="grain-info">
                            <div class="grain-row"><span>R$/ha:</span><span class="grain-value">${c.perHa.toFixed(2)}</span></div>
                            <div class="grain-row"><span>Sacas:</span><span class="grain-value">${c.sacks.toFixed(2)} sc/ha</span></div>
                        </div>
                    </div>
                `;
            }
            
            // 2¬™ melhor
            if (combos[1]) {
                const c = combos[1];
                const diff = c.total - combos[0].total;
                html += `
                    <div class="result second">
                        <h3>ü•à ${c.name}</h3>
                        <div class="result-row"><span>${c.f1.name}:</span><strong>${c.f1.dose.toFixed(1)} kg/ha (${c.f1.ton.toFixed(2)} ton)</strong></div>
                        <div class="result-row"><span>${c.f2.name}:</span><strong>${c.f2.dose.toFixed(1)} kg/ha (${c.f2.ton.toFixed(2)} ton)</strong></div>
                        <div class="result-total"><span>TOTAL:</span><strong>R$ ${c.total.toLocaleString('pt-BR', {minimumFractionDigits:2})}</strong></div>
                        <div class="grain-info">
                            <div class="grain-row"><span>Diferen√ßa:</span><span class="grain-value">+ R$ ${diff.toFixed(2)}</span></div>
                            <div class="grain-row"><span>Sacas:</span><span class="grain-value">${c.sacks.toFixed(2)} sc/ha</span></div>
                        </div>
                    </div>
                `;
            }
            
            res.innerHTML = html;
        }

        window.addEventListener('DOMContentLoaded', () => {
            load();
            render();
        });
    </script>
</body>
</html>
